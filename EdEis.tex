
\begin{frame}{Digitale Signatur und Verschlüsselung I}
\setbeamertemplate{footline}[frame number]
\protect\hypertarget{digitale-signatur-und-verschluxfcsselung-i}{}
\begin{itemize}
\tightlist
\item
  Pendant der schriftlichen Signatur
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Dokument → Erklärung, Vereinbarung
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Nachweis

  \begin{itemize}
  \tightlist
  \item
    Inhalt des Dokument (Unterzeichner)
  \item
    Verifikation (Empfänger)
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Signatur ausschließlich durch Unterzeichner
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Verifikation soll jedem möglich sein
\end{itemize}

siehe (Hühnlein and Korte 2006)
\end{frame}

\begin{frame}{Digitale Signatur und Verschlüsselung II}
\protect\hypertarget{digitale-signatur-und-verschluxfcsselung-ii}{}
\begin{enumerate}
\tightlist
\item
  Eine digitale Signatur ist ein String, welcher eine Nachricht mit
  einer Entität verbindet
\item
  Algorithmus zur Signaturerzeugung\\
\item
  Algorithmus zur Signaturverifikation
\item
  Signatur Schema (signature scheme) → Erzeugung \& Verifikation
\item
  Signaturprozess → Formatierung der Daten in signierbare Nachrichten
\item
  Verfikationsprozess\\
  siehe Katz et al. (1996)
\end{enumerate}
\end{frame}

\begin{frame}{Digitale Signatur und Verschlüsselung III}
\protect\hypertarget{digitale-signatur-und-verschluxfcsselung-iii}{}
\begin{itemize}
\item
  Realisierung durch asymetrische Kryptoalgorithmen
\item
  Message
\item
  K\textsubscript{Priv} , K\textsubscript{Pub}
\item
  Einwegfunktion \[f(K~Priv~) = K~Pub~\]
\item
  inverse Funktionen

  \begin{itemize}
  \tightlist
  \item
    Signatur (Message, K\textsubscript{Priv})
  \item
    Verifikation (Message, Signatur, K\textsubscript{Pub})
  \end{itemize}
\item
  K\textsubscript{Pub} in öffentlichem Verzeichnis\\
  siehe (Hühnlein and Korte 2006)
\end{itemize}
\end{frame}

\begin{frame}{Beispiel für Verwendung von Digitale Signaturen}
\protect\hypertarget{beispiel-fuxfcr-verwendung-von-digitale-signaturen}{}
\begin{itemize}
\tightlist
\item
  SSL Zertifikat (CA)
\item
  Software Installation auf Linux / BSD Systemen
\item
  Elektronische Steuerklärung
\end{itemize}

\includegraphics[width=\textwidth,height=0.6\textheight]{Abbildungen/GPG.png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section}{}
\includegraphics{Abbildungen/ITSEC(1)_res.png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-1}{}
\includegraphics{Abbildungen/Punkt1.png}
\end{frame}

\begin{frame}{ECDSA \& Ed25519}
\protect\hypertarget{ecdsa-ed25519}{}
\begin{itemize}
\tightlist
\item
  Signaturverfahren basierend auf Eliptic Curve Cryptography (ECC)

  \begin{itemize}
  \tightlist
  \item
    Basis ist eine Punktruppe einer Elliptischen Kurve
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\item
  ECDSA ist verbereitet

  \pause

  \begin{itemize}
  \tightlist
  \item
    EdDSA (Edwardscurve)
  \end{itemize}

  \pause

  \begin{itemize}
  \tightlist
  \item
    Ed25519 (Edwardscurve 25519)
  \end{itemize}

  \pause
\item
  160bit ECC Schlüssel = 1200bit RSA Schlüssel

  \begin{itemize}
  \tightlist
  \item
    Speicherverbrauch, Energieverbrauch (IoT)
  \end{itemize}
\end{itemize}

siehe (Hühnlein and Korte 2006; Susella 2018)
\end{frame}

\begin{frame}{ECDSA \& Ed25519}
\protect\hypertarget{ecdsa-ed25519-1}{}
\begin{itemize}
\tightlist
\item
  Verwendung (Susella 2018)

  \begin{itemize}
  \tightlist
  \item
    OpenSSH
  \item
    WolfSSL / OpenSSL / LibreSSL / GnuTLS
  \item
    Tor Protokoll
  \item
    DNS Protokolle
  \item
    Signal Messenger Protokoll
  \end{itemize}
\end{itemize}

\includegraphics[width=\textwidth,height=0.5\textheight]{Abbildungen/openssh.png}
\end{frame}

\begin{frame}{Ed25519 Funktionsweise}
\protect\hypertarget{ed25519-funktionsweise}{}
\textbf{Tafelbild}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-2}{}
\includegraphics{Abbildungen/ITSEC(1).png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-3}{}
\includegraphics{Abbildungen/Punkt2.png}
\end{frame}

\begin{frame}[fragile]{Secure Hash ``SHA512''}
\protect\hypertarget{secure-hash-sha512}{}
\begin{itemize}
\item
  Ed25519 nutzt SHA512

  \begin{itemize}
  \tightlist
  \item
    Merkle--Damgård Konstruktion

    \begin{itemize}
    \tightlist
    \item
      Erweiterung um Davies-Meyer
    \end{itemize}
  \item
    SHA-2 Familie (SHA256,SHA512) → Bitlänge des Hash
  \end{itemize}
\item
  Auxiliary Schlüssel b
\end{itemize}

\begin{lstlisting}
Message M (Länge n) → SHA512 Funktion → 512 Bit Ausgabe
\end{lstlisting}

(Susella 2018)
\end{frame}

\begin{frame}{Secure Hash ``SHA512'' II}
\protect\hypertarget{secure-hash-sha512-ii}{}
\includegraphics{Abbildungen/MD.png}
\end{frame}

\begin{frame}{Secure Hash ``SHA512'' III}
\protect\hypertarget{secure-hash-sha512-iii}{}
\begin{itemize}
\tightlist
\item
  Ausgabe 512 Bit
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Größe des internen Status 512 Bit
\end{itemize}

\pause

\begin{itemize}
\item
  Message expansion auf 80 schedulde words

  \pause

  \begin{itemize}
  \item
    Messageblock 1024 Bit

    \pause

    \begin{itemize}
    \tightlist
    \item
      16 Wörter
    \end{itemize}

    \pause

    \begin{itemize}
    \tightlist
    \item
      Wortgröße von 64 Bit
    \end{itemize}
  \end{itemize}
\item
  80 mal Rundenfunktion auf schedule words
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Operationen auf Status

  \begin{itemize}
  \tightlist
  \item
    AND / XOR
  \item
    Addition (mod 2\textsuperscript{64})
  \end{itemize}
\end{itemize}

(Susella 2018)
\end{frame}

\begin{frame}{Übergabewerte für SHA512}
\protect\hypertarget{uxfcbergabewerte-fuxfcr-sha512}{}
\begin{itemize}
\item
  Wörter 0-3 = Private Key (256 Bit)
\item
  Wörter 4-15 = Message
\end{itemize}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-4}{}
\includegraphics[page=1,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-5}{}
\includegraphics[page=2,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-6}{}
\includegraphics[page=3,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-7}{}
\includegraphics[page=4,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-8}{}
\includegraphics[page=5,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-9}{}
\includegraphics[page=6,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-10}{}
\includegraphics[page=7,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-11}{}
\includegraphics[page=8,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-12}{}
\includegraphics[page=9,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-13}{}
\includegraphics[page=10,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-14}{}
\includegraphics[page=11,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-15}{}
\includegraphics[page=12,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-16}{}
\includegraphics[page=13,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-17}{}
\includegraphics[page=14,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-18}{}
\includegraphics[page=15,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-19}{}
\includegraphics[page=16,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-20}{}
\includegraphics[page=17,width=\paperwidth]{SHAFunkt.pdf}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-21}{}
\includegraphics{Abbildungen/ITSEC(1).png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-22}{}
\includegraphics{Abbildungen/Punkt4.png}
\end{frame}

\begin{frame}{Angriff auf Ed25519}
\protect\hypertarget{angriff-auf-ed25519}{}
\begin{itemize}
\tightlist
\item
  \textbf{Key Recovery} Attacke

  \begin{itemize}
  \tightlist
  \item
    Energieverbrauch eines SOCs
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Angriff bei Berechnung des ``flüchtigen'' privaten Schlüssels

  \begin{itemize}
  \tightlist
  \item
    von Interesse ist Hilfschlüssel b
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Flüchtiger Schlüssel r bekannt

  \begin{itemize}
  \tightlist
  \item
    Scalar a, Hilfsschlüssel b → manipulierte Signaturen
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Angriff auf Ed25519 II}
\protect\hypertarget{angriff-auf-ed25519-ii}{}
\begin{itemize}
\tightlist
\item
  Differential Power Analysis (DPA)

  \begin{itemize}
  \tightlist
  \item
    SDA → Abhängigkeit Daten und Energieverbrauch
  \item
    Energieverbrauch an einem Punkt der Encryption
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Zwischenwert (Intermediate Value)

  \begin{itemize}
  \tightlist
  \item
    Value mit bekanntem Teil/Message
  \item
    Wert als Funktion darstellbar
  \end{itemize}
\end{itemize}

\pause

\[ S(M,k) = Value \]
\end{frame}

\begin{frame}[fragile]{Angriff auf Ed25519 III}
\protect\hypertarget{angriff-auf-ed25519-iii}{}
\begin{itemize}
\tightlist
\item
  64 bit unbekannte Bits

  \begin{itemize}
  \tightlist
  \item
    2\textsuperscript{64} mögliche Schlüssel
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Divide-and-Conquer Strategie

  \begin{itemize}
  \tightlist
  \item
    8 Bit → 256 mögliche Schlüssel
  \end{itemize}
\end{itemize}

\pause

\includegraphics[width=\textwidth,height=0.6\textheight]{Abbildungen/keyDPA.png}

\pause

\begin{itemize}
\tightlist
\item
  Hamming Weight wird berechnet (Anzahl Traces X Key Kandidaten)
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Pearson Korrelation der Zeit (Time Samples, Hamming Weight )
\end{itemize}

\begin{lstlisting}
Zu jedem Schlüssel Kandidaten muss jedes    
Time sample eines Traces zugeordnet werden    
→ korrekte Ausrichtung für jeden Schlüssel  
→ Vergleichbarkeit
\end{lstlisting}
\end{frame}

\begin{frame}{Angriff auf Ed25519 IIII}
\protect\hypertarget{angriff-auf-ed25519-iiii}{}
\includegraphics[width=\textwidth,height=0.95\textheight]{Abbildungen/cvDPA.png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-23}{}
\includegraphics{Abbildungen/ITSEC(1).png}
\end{frame}

\begin{frame}{}
\protect\hypertarget{section-24}{}
\includegraphics{Abbildungen/Punkt5.png}
\end{frame}

\begin{frame}{Verbesserung \& Gegenmaßnahmen}
\protect\hypertarget{verbesserung-gegenmauxdfnahmen}{}
\begin{itemize}
\tightlist
\item
  Schlüssel \& Nachricht nicht gemeinsam in Kompressionsfunktion
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Padding bereits bei Schlüssel durchführen

  \begin{itemize}
  \tightlist
  \item
    Random Werte
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Vorteil

  \begin{itemize}
  \tightlist
  \item
    Verifikation Sigantur bleibt gleich
  \item
    Implemetierung des SHA wird geändert
  \end{itemize}
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Nachteil für IoT

  \begin{itemize}
  \tightlist
  \item
    Verlust der deterministischen Berechnung
  \item
    Berechnungszeit steigt
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{IN A NUTSHELL}
\protect\hypertarget{in-a-nutshell}{}
\begin{itemize}
\tightlist
\item
  Signaturerzeugung
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  geheime Schlüssel errechnen
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Schwachstelle = ``fahrlässige'' \textbf{Nutzung} des SHA512
\end{itemize}

\pause

\begin{itemize}
\tightlist
\item
  Fehlerhafte Implementierung → leichte Gegenmaßnahme
\end{itemize}
\end{frame}

\begin{frame}{Literatur}
\protect\hypertarget{literatur}{}
\hypertarget{refs}{}
\begin{cslreferences}
\leavevmode\hypertarget{ref-huhnlein2006grundlagen}{}%
Hühnlein, Detlef, and Ulrike Korte. 2006. \emph{Grundlagen Der
Elektronischen Signatur: Recht-Technik-Anwendung}. SecuMedia-Verlag.

\leavevmode\hypertarget{ref-katz1996handbook}{}%
Katz, Jonathan, Alfred J Menezes, Paul C Van Oorschot, and Scott A
Vanstone. 1996. \emph{Handbook of Applied Cryptography}. CRC press.

\leavevmode\hypertarget{ref-susella2018breaking}{}%
Susella, Ruggero. 2018. ``Breaking Ed25519 in Wolfssl.'' In \emph{Topics
in Cryptology--Ct-Rsa 2018: The Cryptographers' Track at the Rsa
Conference 2018, San Francisco, ca, Usa, April 16-20, 2018,
Proceedings}, 10808:1. Springer.
\end{cslreferences}
\end{frame}
